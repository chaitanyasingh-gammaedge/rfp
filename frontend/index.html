<!doctype html>
<html>
<head><meta charset="utf-8"/><title>RPF Generator</title></head>
<body>
<h2>RPF Generator</h2>
<select id="modelSelect"></select><br/><br/>
<input type="file" id="fileInput"/>
<input type="text" id="urlInput" placeholder="Or paste URL"/>
<button id="ingestBtn">Ingest</button>
<hr/>
<div id="chat"></div>
<textarea id="prompt" rows="5" cols="80" placeholder="Write your request"></textarea><br/>
<button id="genBtn">Generate Proposal</button>

<script>
async function loadModels(){
 const r=await fetch('/api/models'); const m=await r.json();
 const s=document.getElementById('modelSelect');
 m.forEach(x=>{let o=document.createElement('option');o.value=x.id;o.text=x.display;s.appendChild(o);});
}
document.getElementById('ingestBtn').onclick=async()=>{
 const f=document.getElementById('fileInput'); const url=document.getElementById('urlInput').value;
 const fd=new FormData(); if(f.files.length) fd.append('file',f.files[0]); if(url) fd.append('url',url);
 const r=await fetch('/api/ingest',{method:'POST',body:fd}); alert(await r.text());
}
document.getElementById('genBtn').onclick=async()=>{
 const model=document.getElementById('modelSelect').value;
 const prompt=document.getElementById('prompt').value;
 const r=await fetch('/api/generate',{method:'POST',headers:{'Content-Type':'application/json'},
   body:JSON.stringify({model,prompt})});
 const j=await r.json(); document.getElementById('chat').innerText=j.content;
}
loadModels();
</script>
</body></html>
